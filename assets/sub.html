<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>LingRoboMX Beta0.9</title>
    <script src="./js/libs/flexible.js"></script>
    <!-- <script src=".js/libs/random-js.ems.js"></script> -->
    <!-- <script src="./js/libs/jquery.min.js"></script> -->
    <!-- <span class="glyphicon glyphicon-ok"></span> -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous"> -->
    
    <!-- <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script> -->
    <script type="module">
        window.$ = window.jQuery = require('./js/libs/jquery.min.js');
    </script>
    <!-- <script src = "https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js">
         -->
         <script src="./js/libs/chart.js">
    </script>
    <script src="./js/api/helper.js"></script>
    <script src="./js/user_api/common.js"></script>
    <!-- <script src="./js/libs/bootstrap.min.js"></script> -->
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/bootstrap-icons/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="./css/index.css">
<!-- <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-7ymO4nGrkm372HoSbq1OY2DP4pEZnMiA+E0F3zPr+JQQtQ82gQ1HPY3QIVtztVua" crossorigin="anonymous"></script> -->
    <!-- <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script> -->
    <script src="./js/tools/string_mcu.js"></script>
    <script src="./js/station/view.js"></script>
    <script src="./js/tools/common_utils.js"></script>
    <script src="./js/station/panel.js"></script>
    <script src="./js/station/standard_panel.js"></script>
    <script src="./js/api/protocol.js"></script>
    <script src="./js/station/protocol_panel.js"></script>
    <!-- <script src="./js/station/device_panel.js"></script> -->
    <script src="./js/station/about_panel.js"></script>

    <script src="./js/libs/babylon.js"></script>
    <script src="./js/libs/babylonjs.loaders.min.js"></script>

    <script>
        var robot_is_render = true;
    </script>
    <script src="./js/station/robot_panel.js"></script>
    <script src="./js/station/system.js"></script>
</head>

<body oncontextmenu='return false' ondragstart='return false' onselectstart='return false' onbeforecopy='return false'
   >
    <div class="title-box" style="display: none;">
        <div class="btn-group title-btn-group" role="group" style="display: none;">
            <button type="button" class="btn btn-title" id="btn-robot"><i class="bi bi-robot"></i>&nbsp;机器人</button>
            <button type="button" class="btn btn-title" id="btn-protocol" style="display: none;"><i class="bi bi-grid-1x2"></i>&nbsp;协议管理</button>
            <!-- <button type="button" class="btn btn-title" id="btn-device"><i class="bi bi-gear"></i>&nbsp;设备管理</button> -->
            <button type="button" class="btn btn-title" id="btn-standard" style="display: none;"><i class="bi bi-hdd-rack"></i>&nbsp;基本串口</button>
            <button type="button" class="btn btn-title" id="btn-about" style="display: none;"><i class="bi bi-at"></i>&nbsp;关于</button>
            <!-- <button type="button" class="btn btn-title" id="btn-login"><i class="bi bi-cup-hot"></i>&nbsp;登录</button> -->
        </div>
        <div class="title-text-box text-center" style="display: none;">
            <h3 id="title-text"  style="font-size: calc(0.1vh + 2vw);">基本串口</h3>
        </div>
        
        <div class="robot-com" id="robot-com-id" style="display: none;">
            <div class="form-group robot-com-input">
                <label for="disabledSelect">串口</label>
                <select id="robot-disabledSelect" class="form-control robot-com" style="width: 130px;height: 28px;">
                </select>
            </div>
            <div class="form-group robot-com-input">
                <label for="BaudRate">波特率</label>
                <input type="text" class="form-control" id="robot-BaudRate" value="921600" style="width: 130px;height: 28px;">
            </div>
            <div class="submit-data" style="width: 60px;">
                <button class="btn btn-primary btn-block btn-submit" id="robot-com-btn" style="height: 60px;background-color: #FAFAFA;color: black;">连接</button>
            </div>
        </div>

        <!-- <img src="./img/0bug.png" style="flex-direction: right;"> -->
        <!-- <div class="submit-data" style="width: 60px;">
            <button class="btn btn-primary btn-block btn-submit" id="login-btn" style="height: 60px;background-color: #FAFAFA;color: black;">登录</button>
        </div> -->
    </div>
    <div class="body-box-full" id="panel-standard" style="display: none;">
        <div class="tool-bar">
            <div class="select-data">
                <div class="form-group">
                    <label for="disabledSelect">选择串口</label>
                    <select id="disabledSelect" class="form-control com">
                    </select>
                </div>
                <div class="form-group">
                    <label for="BaudRate">波特率</label>
                    <input type="text" class="form-control" id="BaudRate" value="921600">
                </div>
            </div>
            <div class="submit-data">
                <button class="btn btn-primary btn-block btn-submit" id="com-open-btn">打开</button>
            </div>
        </div>
        <div class="content-box">
            <div class="receive-box">
                <div class="send-header">
                    <label>接受信息</label>
                </div>
                <div class="receive-windows">
                </div>
            </div>

            <div class="send-box">
                <div class="send-header">
                    <label>发送信息</label>
                </div>
                <div class="send-windows">
                    <textarea class="input-send-data" id="com-input-data"></textarea>
                </div>
                <div class="send-btn">
                    <div class="btn-box">
                        <div class="btn btn-success btn-send" id="com-send-btn">发送信息</div>&nbsp&nbsp&nbsp
                        <div class="btn btn-warning btn-reset" id="com-clear-btn">清空信息</div>
                        <div class="btn btn-danger btn-reset" id="com-clear-input-btn">清空输入</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="body-box-full" id="panel-protocol" style="display: none;">
        <div class="tool-bar-protocol">
            <div class="btn-protocol-box" id="select-box-protocol">
                <label>消息列表</label>
                <!-- <button type="button" class="btn btn-protocol" id="btn-protocol-IMUData">IMUData</button>
                <button type="button" class="btn btn-protocol" id="btn-protocol-IMUData1">IMUData1</button>
                <button type="button" class="btn btn-protocol" id="btn-protocol-IMUData2">IMUData2</button> -->
            </div>
            <div class="btn btn-warning btn-send" id="gen-btn-protocol">输出设置</div>
        </div>
        <div class="content-box" id="content-box-protocol">
            <div class="send-header">
                <label id="header-protocol-box">详细信息</label>
            </div>
            <div class="protocol-msg-box" id="box-protocol-gen-code">
                <div class="send-header">
                    <label>输出平台</label>
                </div>
                <select id="select-platfrom-protocol-gen-code" class="form-control">
                    <option value="mcu">MCU-Robo Template</option>
                    <option value="ros2">ROS2-Robo Bridge</option>
                </select>
                <br>
                <div class="send-header">
                    <label>版本</label>
                </div>
                <select id="select-version-protocol-gen-code" class="form-control">
                    
                </select>
                <br>
                <div class="send-header">
                    <label>部署机构</label>
                </div>
                <select id="select-structure-protocol-gen-code" class="form-control">
                    <option value="gimbal">GIMBAL 云台</option>
                    <option value="chassis">CHASSIS 底盘</option>
                </select>
                <br>
                <div class="send-header">
                    <label>帧头信息</label>
                </div>
                <label for="frame-from-input-protocol">本机地址</label>
                <input type="text" class="form-control" id="frame-from-input-protocol" readonly="readonly" placeholder="0xFF">
                <label for="frame-to-input-protocol">目标地址</label>
                <input type="text" class="form-control" id="frame-to-input-protocol" readonly="readonly" placeholder="0xEE">
                <br>
                <button class="btn btn-primary btn-block btn-submit" id="gen-confirm-btn-protocol">输出代码</button>
            </div>
        </div>
        
    </div>

    <div class="body-box-full" id="panel-device" style="display: none;">
        <div class="tool-bar-protocol">
            <div class="btn-protocol-box" id="select-box-device">
                <label>消息列表</label>
                <!-- <button type="button" class="btn btn-protocol" id="btn-protocol-IMUData">IMUData</button>
                <button type="button" class="btn btn-protocol" id="btn-protocol-IMUData1">IMUData1</button>
                <button type="button" class="btn btn-protocol" id="btn-protocol-IMUData2">IMUData2</button> -->
            </div>
        </div>
        <div class="content-box" id="content-box-device">
            <div class="send-header">
                <label id="header-device-box">详细信息</label>
            </div>
        </div>
    </div>

    <div class="body-box-full" id="panel-about">
        <p>
            凌BUG机器人上位机-by Xianhao Ji<br>
            联系方式 potpaste@foxmail.com
        </p>
        
    </div>

    <div class="body-box-full" id="panel-robot">
        <div class="tool-bar-robot" id="tool-bar-robot">
            <div class="btn-protocol-box" id="select-box-robot">
                <!-- <label>消息列表</label> -->
                <div class="canvas-box-robot" style="flex-basis: 0; flex-grow : 0;
                flex-shrink: 0;display: none;">
                    <!-- <canvas id="renderCanvas"></canvas> -->
                    <div class="debug-text-robot" id="debug-text-robot">
                        <label>WARNING</label>
                        <label>NOT CONNECTED</label>
                    </div>
                </div>
                <div class="robot-header" style="flex-basis: 0; flex-grow : 0;
                flex-shrink: 0;">
                    <div class="btn-group title-btn-group" role="group">
                        <button type="button" class="btn btn-title" id="btn-robot-msglist"><i class="bi bi-chat-left-text"></i>&nbsp;接受消息</button>
                        <button type="button" class="btn btn-title" id="btn-robot-sendlist"><i class="bi bi-chat-right-text"></i>&nbsp;发送消息</button>
                        <button type="button" class="btn btn-title" id="btn-robot-vehicleview"><i class="bi bi-speedometer2"></i>&nbsp;仪表盘</button>
                        <!-- <button type="button" class="btn btn-title" id="btn-robot-screen"><i class="bi bi-archive"></i></i>&nbsp;新窗口</button>  -->
                    </div>
                
                </div>
                <div class="select-box-robot-msglist" id="select-box-robot-msglist"></div>
                <div class="select-box-robot-msglist" id="select-box-robot-sendlist" style="display: none;"></div>
                    
                    <!-- <label>消息列表</label>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                        <label>消息列表</label>
                        <label>仪表盘</label>
                    </div> -->
                    <!-- <div class="btn-protocol-box" id="vehicleview-robot"> -->
                        <!-- <div style=" display: flex;overflow-y: auto;
                        overflow-x: hidden;height: 100%;flex-grow: 1;justify-content: space-between;"> -->
                        <div class="dashboard_wrapper" id="vehicleview-robot">
                        <!-- </div> -->
                        </div>
                    <!-- </div> -->
                
                <!-- <button type="button" class="btn btn-protocol" id="btn-protocol-IMUData">IMUData</button> -->
                <!-- <button type="button" class="btn btn-protocol" id="btn-protocol-IMUData">IMUData</button>
                <button type="button" class="btn btn-protocol" id="btn-protocol-IMUData1">IMUData1</button>
                <button type="button" class="btn btn-protocol" id="btn-protocol-IMUData2">IMUData2</button> -->
            </div>
            
            <!-- <div class="send-header">
                <label>消息列表</label>
            </div> -->
        </div>
        <div class="horizon_resize_box" id="robot-split-horizon">
        </div>
        <script>
            function download(selector) {
            // 通过 API 获取目标 canvas 元素
            const canvas = document.querySelector(selector);

            // 创建一个 a 标签，并设置 href 和 download 属性
            const el = document.createElement('a');
            // 设置 href 为图片经过 base64 编码后的字符串，默认为 png 格式
            el.href = canvas.toDataURL();
            el.download = 'chart';
            
            // 创建一个点击事件并对 a 标签进行触发
            const event = new MouseEvent('click');
            el.dispatchEvent(event);
            }

        </script>
        <div class="robot-body-box" id="robot-body-box">
            <!-- <div class="my-title">
            <button type="button" class="btn btn-pause" id="my-title-minus" style=" border-radius: 50%;aspect-ratio: 1 / 1;display: flex;
            justify-content: center;" title="最小化"><i class="bi bi-dash"></i></button>
            <button type="button" class="btn btn-pause" id="my-title-resize" style=" border-radius: 50%;aspect-ratio: 1 / 1;display: flex;
            justify-content: center;" title="最大化/窗口化"><i class="bi bi-aspect-ratio"></i></button>
            <button type="button" class="btn btn-pause" id="my-title-close" style=" border-radius: 50%;aspect-ratio: 1 / 1;display: flex;
            justify-content: center;" title="关闭"><i class="bi bi-power"></i></button>
        </div> -->
            <div class="content-box-robot" id="content-box-robot" style="position: relative;">
                <div class="send-header" style="display: flex;flex-direction: row;"">
                    <div style="display: flex;-webkit-app-region: drag;flex-grow: 1;">
                        <label id="header-robot-box" class="title-text2">详细信息</label>
                    </div>
                    <!-- <button type="button" class="btn btn-pause" id="send-header-minus" title="最小化"><i class="glyphicon glyphicon-minus"></i></button> -->
                    <button type="button" class="btn btn-pause" id="send-header-send" title="发送" style="display: none;">开始发送</button>
                    <button type="button" class="btn btn-pause" id="send-header-pause" title="暂停/继续" style="display: none;"><i class="glyphicon glyphicon-pause"></i></button>
                    <button type="button" class="btn btn-pause" id="my-title-top" style="
            justify-content: center;" title="置顶"><i class="bi bi-arrow-up-square"></i></button>
                    <button type="button" class="btn btn-pause" id="my-title-minus" style="
            justify-content: center;" title="最小化"><i class="bi bi-dash"></i></button>
            <button type="button" class="btn btn-pause" id="my-title-resize" style="
            justify-content: center;" title="最大化/窗口化"><i class="bi bi-aspect-ratio"></i></button>
            <button type="button" class="btn btn-pause" id="my-title-close" style="
                    justify-content: center;" title="关闭"><i class="bi bi-power"></i></button>
                </div>

                <div class="send-header" id="send-header-send-option"
                    style="display: none; position: absolute; bottom: 0;background-color: #FAFAFA;width: 100%;opacity: 1.0;z-index: 999;">
                    <div class="row mb-3">
                        <div class="col-sm-6" style="display: flex; flex-direction: row;">
                            <label style="display: flex;padding: 2px;">发送频率</label>
                            <div style="display: flex;padding: 2px;"><input type="text" class="form-control"
                                    id="send-freq-input" style="width: 80%;height: 80%;border:1px solid #898989;box-shadow: none;
                            outline:0;" value=""></div>
                        </div>
                        <div class="col-sm-6" style="display: flex; flex-direction: row;">
                            <label style="display: flex;padding: 2px;">发送次数</label>
                            <div style="display: flex;padding: 2px;"><input type="text" class="form-control"
                                id="send-count-input" style="width: 80%;height: 80%;border:1px solid #898989;box-shadow: none;
                        outline:0;" value=""></div>
                        </div>
                    </div>
                </div>
                <!-- <div style="z-index: 999; background-color: #b64545; height: 10px; width: 10px; right: 0px; bottom: 0px; position: fixed;"> 
    
                </div> -->
            </div>
            <div class="vertical_resize_box" id="robot-split-vertial">

            </div>
            <div class="plot-robot" id="plot-robot">
                <div class="send-header-plot">
                    <label id="header-robot-plot" class="title-text2">绘图</label>
                    <!-- <button type="button" class="btn btn-pause" id="send-header-plot-minus" title="最小化"><i class="glyphicon glyphicon-minus"></i></button> -->
                    <button type="button" class="btn btn-pause" id="send-header-plot-pause" title="暂停/继续"><i class="glyphicon glyphicon-pause"></i></button>
                    <button type="button" class="btn btn-pause" id="send-header-plot-clear" title="清空曲线"><i class="glyphicon glyphicon-trash"></i></button>
                    <button type="button"  onclick="download('#chart-robot-plot')" class="btn btn-pause" id="send-header-plot-download" title="下载图像"><i class="glyphicon glyphicon-camera"></i></button>
                </div>
                <div class="content-box-robot" style="height: 100%;">
                    <canvas id = "chart-robot-plot" class="chart-robot"> </canvas>
                </div>
                <!-- <div class="content-box-robot" style="height: 0%;">
                    <canvas id = "vehicleview-robot" class="vehicleview-robot"> </canvas>
                </div> -->

            </div>                
        </div>
    </div>

    <!-- <div class="tips-box">tipsssssssssssssssssssssssssssss</div> -->
</body>
<script type="module">
    // let port = null;
    // SerialPort.list((err, ports) => {
    //     mylog(ports);
    //     for (let item of ports) {
    //         $('.com').append(`<option>${item.path}</option>`)
    //     }
    //     mylog(ports);
    // });
    // $('.btn-submit').click((data) => {
    //     let COM = $('select option:selected').text();
    //     let BaudRate = $('#BaudRate').val();
    //     mylog(COM);
    //     mylog(BaudRate);
    //     port = new SerialPort(COM, {
    //         baudRate: parseInt(BaudRate)
    //     });
    //     $('.receive-windows').text(`打开串口: ${COM}, 波特率: ${BaudRate}`);
    //     $('.receive-windows').append('<br/>=======================================<br/>');
    //     port.on('data', data => {
    //         mylog(`DATA: ${data}`);
    //         $('.receive-windows').append(data.toString());
    //     });
    // });
    let system = System(20);

    let standard_panel = StandardPanel('standard');
    let protocol_panel = ProtocolPanel('protocol');
    // let device_panel = DevicePanel('device');
    let about_panel = AboutPanel('about');
    let robot_panel = RobotPanel('robot');

    system.register('standard', standard_panel);
    system.register('protocol', protocol_panel);
    // system.register('device', device_panel);
    system.register('about', about_panel);
    system.register('robot', robot_panel);

    system.changePanel('robot');

    // $('#btn-standard').click(() => {
    //     alert("hello");
    // })
    // 点击发送信息
    // $('.btn-send').click(() => {
    //     var sendData = $('.input-send-data').val();
    //     if (port != {} && port != null) {
    //         mylog(`SendData: ${sendData}`);
    //         port.write(sendData);
    //     }
    // })
    // // 清空信息
    // $('.btn-reset').click(() => {
    //     $('.input-send-data').val('');
    // })
</script>

</html>